# Offers Management

This page describes the handling of APIs for the management of offers (sell orders). The general workflow is as follows:

1. First, the FSP must create an order batch
2. Then, the FSP can create offers with reference to the order batch
3. Eventually the FSP is able to publish its offers
   

## Create an order batch
This Endpoint is to be used whenever an FSP wants to create a new order batch into the LocalFlex platform.

`POST` `/api/orderBatch`


**Requested body schema of an** `orderBatch`:


|Field|Description |Allowable responses/examples|
|---|---|---|
|mrid (*string*)|Universally unique id for the batch|'3fa85f64-5717-4562-b3fc-2c963f66afa6'|
|status (*string*)|The status of the batch|enum: `'Draft'`, `'Published'`|
|items (*array*)|An array of offers|['3fa85f64-5717-4562-b3fc-2c963f66afa6']|

**Example**
```
{
  "mrid": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "status":"Draft",
  "items": []
}
```


**Responses:**


`200` successful operation
```
{
  "result": orderBatch{...}, 
  "status": true,
  "code": 200
}
```


`401` Access token is missing or invalid
```
{
  "result": "string",
  "status": true,
  "code": 401
}
```


`403` You don't have have the permission to access the response
```
{
  "result": "string",
  "status": true,
  "code": 403
}
```



## Create a new offer
This Endpoint is to be used whenever an FSP wants to create a new offer into the LocalFlex platform. This has to be done, once the order batch exists.

`POST` `/offer`

**Requested body schema of an** `offer`:


|Field|Description |Allowable responses/examples|
|---|---|---|
|mrid (*string*)|Universally unique id for the offer|'3fa85f64-5717-4562-b3fc-2c963f66afa6'|
|businessType (*string*)|Nature of the product, as defined in the market rules|enum: `'DA'`|
|currency (*string*)|Currency used|enum: `'GBP'`|
|direction (*string*)|Direction of the energy flow (Defined in the market rules)|enum: `'UP'`, `'DOWN'`|
|measureUnitQuantity (*string*)|Unit of measurement for flexibility available|enum: `'MW'`|
|measureUnitEnergyQuantity (*string*)|Unit of measurement for the energy (utilisation component of the flexibility available)|enum: `'MWh'`|
|status (*string*)|Offer Status|enum: `'Draft'`, `'Published'`|
|flexQtyConvention (*string*)|Flex Qty Convention|enum: `'Load'`, `'Generation'`|
|reserveObjectLevel (*string*)|Reserve object level|enum: `'Asset'`, `'Portfolio'`|
|reserveObjectMrid (*string*)|Unique mrid of the asset or portfolio where the energy is delivered|'5kb85f65-4632-4562-c6ji-1t764y92zyq3|
|pricePeriodUnit (*string*)|For what time unit the price is defined per measureUnitQuantity and measureUnitEnergyQuantity|enum: `'Hr'`|
|minActivationQuantity (*number*)|Minimum quantity at which the offer can be accepted for each period|1|
|constraints (*object*)|constraints of the resource. Contains data on capabilities of the resources: maximum energy, ramping rate, minimum and maximum duration of flexibility dispatch, resting duration and activation duration (i.e. time to regulate)||
|periods (*array*)|Period of the offer. It contains information on time interval, resolution and on data details within that interval (quantity, price, energy quantity and energy price)||
|bmAvailable (*boolean*)|Boolean value to determine whether or not a BMOffer should be created post auction for the BM|enum: `true`, `false`|
|orderBatchMrid (*string*)|Order batch Identifier|'3fa85f64-5717-4562-b3fc-2c963f66afa6'|


**Example**

````
{
  "mrid": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "businessType": "DA",
  "currency": "GBP",
  " direction": "UP",
  "measureUnitQuantity": "MW",
  "measureUnitEnergyQuantity": "MWh",
  "status": "Draft",
  "flexQtyConvention":"Generation",
  "reserveObjectLevel":"Portfolio",
  "reserveObjectMrid": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "pricePeriodUnit": "Hr",
  "minActivationQuantity": 0,
  "constraints": {
    "maximumEnergy": {
      "energy": 0,
      "duration": 0
      },
    "ramping": {
      "up": 0,
      "down": 0
      },
    "minimumDuration": 0,
    "maximumDuration": 0,
    "restingDuration": 0,
    "activationDuration": 0
  },
  "periods": [
    {
      "timeInterval": "YYYY-MM-DDTHH:MMZ/YYYY-MM-DDTHH:MMZ",
      "resolution": "PT15M",
      "intervals": [
        {
          "pos": 0,
          "qty": 0,
          "energyQty": 0,
          "price": 0,
          "energyPrice": 0
        }
      ]
    }
  ],
  "bmAvailable": true,
  "orderBatchMrid": "3fa85f64-5717-4562-b3fc-2c963f66afa6"
}
````


**Responses:**


`200` successful operation
```
{
  "result": offer{...}, 
  "status": true,
  "code": 200
}
```

`401` Access token is missing or invalid
```
{
  "result": "string",
  "status": true,
  "code": 401
}
```


`403` You don't have have the permission to access the response
```
{
  "result": "string",
  "status": true,
  "code": 403
}
```




## Retrieve a single offer
This Endpoint is to be used whenever an FSP wants to retrieve a single offer from the LocalFlex platform.

`GET` `/offer/{mrid}`

**Parameter** 
|Parameter|description|
|---|---|
|mrid|The mrid of the offer to return|




**Responses:**

`200` successful operation
```
{
  "result": offer{...}, 
  "status": true,
  "code": 200
}
```

`401` Access token is missing or invalid
```
{
  "result": "string",
  "status": true,
  "code": 401
}
```

`403` You don't have have the permission to access the response
```
{
  "result": "string",
  "status": true,
  "code": 403
}
```




## Update a single offer
This Endpoint is to be used whenever an FSP wants to retrieve a single offer from the LocalFlex platform.

`PUT` `/offer/{mrid}`

**Parameter** 
|Parameter|description|
|---|---|
|mrid|The mrid of the offer to update|

**Requested body schema of an** `offer`:


|Field|Description |Allowable responses/examples|
|---|---|---|
|mrid (*string*)|Universally unique id for the offer|'3fa85f64-5717-4562-b3fc-2c963f66afa6'|
|businessType (*string*)|Nature of the product, as defined in the market rules|enum: `'DA'`|
|currency (*string*)|Currency used|enum: `'GBP'`|
|direction (*string*)|Direction of the energy flow (Defined in the market rules)|enum: `'UP'`, `'DOWN'`|
|measureUnitQuantity (*string*)|Unit of measurement for flexibility available|enum: `'MW'`|
|measureUnitEnergyQuantity (*string*)|Unit of measurement for the energy (utilisation component of the flexibility available)|enum: `'MWh'`|
|status (*string*)|Offer Status|enum: `'Draft'`, `'Published'`|
|flexQtyConvention (*string*)|Flex Qty Convention|enum: `'Load'`, `'Generation'`|
|reserveObjectLevel (*string*)|Reserve object level|enum: `'Asset'`, `'Portfolio'`|
|reserveObjectMrid (*string*)|Unique mrid of the asset or portfolio where the energy is delivered|'5kb85f65-4632-4562-c6ji-1t764y92zyq3|
|pricePeriodUnit (*string*)|For what time unit the price is defined per measureUnitQuantity and measureUnitEnergyQuantity|enum: `'Hr'`|
|minActivationQuantity (*number*)|Minimum quantity at which the offer can be accepted for each period|1|
|constraints (*object*)|constraints of the resource. Contains data on capabilities of the resources: maximum energy, ramping rate, minimum and maximum duration of flexibility dispatch, resting duration and activation duration (i.e. time to regulate)||
|periods (*array*)|Period of the offer. It contains information on time interval, resolution and on data details within that interval (quantity, price, energy quantity and energy price)||
|bmAvailable (*boolean*)|Boolean value to determine whether or not a BMOffer should be created post auction for the BM|enum: `true`, `false`|
|orderBatchMrid (*string*)|Order batch Identifier|'3fa85f64-5717-4562-b3fc-2c963f66afa6'|


**Example**

````
{
  "mrid": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "businessType": "DA",
  "currency": "GBP",
  " direction": "UP",
  "measureUnitQuantity": "MW",
  "measureUnitEnergyQuantity": "MWh",
  "status": "Draft",
  "flexQtyConvention":"Generation",
  "reserveObjectLevel":"Portfolio",
  "reserveObjectMrid": "3fa85f64-5717-4562-b3fc-2c963f66afa6",
  "pricePeriodUnit": "Hr",
  "minActivationQuantity": 0,
  "constraints": {
    "maximumEnergy": {
      "energy": 0,
      "duration": 0
      },
    "ramping": {
      "up": 0,
      "down": 0
      },
    "minimumDuration": 0,
    "maximumDuration": 0,
    "restingDuration": 0,
    "activationDuration": 0
  },
  "periods": [
    {
      "timeInterval": "YYYY-MM-DDTHH:MMZ/YYYY-MM-DDTHH:MMZ",
      "resolution": "PT15M",
      "intervals": [
        {
          "pos": 0,
          "qty": 0,
          "energyQty": 0,
          "price": 0,
          "energyPrice": 0
        }
      ]
    }
  ],
  "bmAvailable": true,
  "orderBatchMrid": "3fa85f64-5717-4562-b3fc-2c963f66afa6"
}
````

**Responses:**

`200` successful operation
```
{
  "result": offer{...}, 
  "status": true,
  "code": 200
}
```

`401` Access token is missing or invalid
```
{
  "result": "string",
  "status": true,
  "code": 401
}
```

`403` You don't have have the permission to access the response
```
{
  "result": "string",
  "status": true,
  "code": 403
}
```





























